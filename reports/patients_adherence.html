<!DOCTYPE html>
<html lang="en" >
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Patients Adherence Report</title>
		<link href="../CSS/style.css" type="text/css" rel="stylesheet"/>
		<link rel="SHORTCUT ICON" href="../Images/favicon.ico">
		<link href="../Scripts/bootstrap/css/bootstrap.min.css" media="screen" type="text/css" rel="stylesheet"/>
		<link href="../CSS/offline_css.css" type="text/css" rel="stylesheet"/>
		<link href="../CSS/jquery-ui.css" type="text/css" rel="stylesheet"/>
		<link href="TableFilter/filtergrid.css" type="text/css" rel="stylesheet"/>
		<script type="text/javascript" src="../Scripts/jquery.js"></script>
		<script type="text/javascript" src="../Scripts/jquery-ui.js"></script>
		<script type="text/javascript" src="../Scripts/offline_database.js"></script>
		<script type="text/javascript" src="../Scripts/offlineData.js"></script>
		<script type="text/javascript" src="TableFilter/tablefilter_all.js"></script>
		<script>
			$(document).ready(function() {
				$.get('reports_include.html', function(data) {
					$('.result').html(data);
				});
			});

		</script>
		<script type="text/javascript">
			$(document).ready(function() {
				initDatabase();
				var $_GET = getQueryParams(document.location.hash);
				var start_date = $_GET['start_date'];
				var end_date = $_GET['end_date'];
				$("#start_date").val($.datepicker.formatDate('dd-M-yy', new Date(start_date)));
				$("#end_date").val($.datepicker.formatDate('dd-M-yy', new Date(end_date)));
				//Get the environmental variables to display the hospital name
				selectEnvironmentVariables(function(transaction, results) {
					// Handle the results
					var row = results.rows.item(0);
					$("#facility_name").text(row['facility_name']);
					var facility = row['facility'];
					var pill_sql = "SELECT SUM(pill_count) as pill_count,SUM(missed_pills) as missed_pills,adherence,SUM(pv.quantity) as quantity, frequency, p.patient_number_ccc, p.service, p.gender,strftime('%Y', date()) - strftime('%Y', p.dob ) as age FROM patient_visit pv LEFT JOIN patient p ON p.patient_number_ccc = pv.patient_id LEFT JOIN dose ds ON ds.name = pv.dose LEFT JOIN drugcode dc ON dc.id=pv.drug_id  WHERE dispensing_date BETWEEN  '" + start_date + "' AND  '" + end_date + "' AND pv.facility ='" + facility + "' AND frequency <=2 AND (pv.regimen !='33' OR dc.drug LIKE '%COTRIMOXAZOLE%' OR dc.drug LIKE '%DAPSONE%' ) GROUP BY p.patient_number_ccc";
					//console.log(pill_sql);
					SQLExecuteAbstraction(pill_sql, function(transaction, results) {
						var missed_pills_count_100 = 0;
						var missed_pills_count_95 = 0;
						var missed_pills_count_85 = 0;
						var missed_pills_count_80 = 0;

						var two_missed_pills_count_100 = 0;
						var two_missed_pills_count_95 = 0;
						var two_missed_pills_count_85 = 0;
						var two_missed_pills_count_80 = 0;

						var pills_count_100 = 0;
						var pills_count_95 = 0;
						var pills_count_85 = 0;
						var pills_count_80 = 0;

						var appoint_pills_count_100 = 0;
						var appoint_pills_count_95 = 0;
						var appoint_pills_count_85 = 0;
						var appoint_pills_count_80 = 0;

						var two_pills_count_100 = 0;
						var two_pills_count_95 = 0;
						var two_pills_count_85 = 0;
						var two_pills_count_80 = 0;

						//Appointment variables
						//Count for ARVs/OI in all levels of appointments
						var appointment_arv_100=0;
						var appointment_oi_100=0;
						var appointment_arv_95=0;
						var appointment_oi_95=0;
						var appointment_arv_85=0;
						var appointment_oi_85=0;
						var appointment_arv_80=0;
						var appointment_oi_80=0;
						
						//Variables to hold gender
						var appointment_male_100=0;
						var appointment_female_100=0;
						var appointment_male_95=0;
						var appointment_female_95=0;
						var appointment_male_85=0;
						var appointment_female_85=0;
						var appointment_male_80=0;
						var appointment_female_80=0;
						
						//Variables for Age
						var appointment_lt14_100=0;
						var appointment_lt15_100=0;
						var appointment_lt24_100=0;
						
						var appointment_lt14_95=0;
						var appointment_lt15_95=0;
						var appointment_lt24_95=0;
						
						var appointment_lt14_85=0;
						var appointment_lt15_85=0;
						var appointment_lt24_85=0;
						
						var appointment_lt14_80=0;
						var appointment_lt15_80=0;
						var appointment_lt24_80=0;
						
						//Missed doses
						//Variables to hold total
						var missed_total_100=0;
						var missed_total_95=0;
						var missed_total_85=0;
						var missed_total_80=0;
						var missed_2_total_100=0;
						var missed_2_total_95=0;
						var missed_2_total_85=0;
						var missed_2_total_80=0;
						
						//Variables to hold gender
						var missed_1_male_100=0;
						var missed_1_female_100=0;
						var missed_1_male_95=0;
						var missed_1_female_95=0;
						var missed_1_male_85=0;
						var missed_1_female_85=0;
						var missed_1_male_80=0;
						var missed_1_female_80=0;
						var missed_2_male_100=0;
						var missed_2_female_100=0;
						var missed_2_male_95=0;
						var missed_2_female_95=0;
						var missed_2_male_85=0;
						var missed_2_female_85=0;
						var missed_2_male_80=0;
						var missed_2_female_80=0;
						
						//Variables for Age
						var missed_1_lt14_100=0;
						var missed_1_lt15_100=0;
						var missed_1_lt24_100=0;
						var missed_2_lt14_100=0;
						var missed_2_lt15_100=0;
						var missed_2_lt24_100=0;
						
						var missed_1_lt14_95=0;
						var missed_1_lt15_95=0;
						var missed_1_lt24_95=0;
						var missed_2_lt14_95=0;
						var missed_2_lt15_95=0;
						var missed_2_lt24_95=0;
						
						var missed_1_lt14_85=0;
						var missed_1_lt15_85=0;
						var missed_1_lt24_85=0;
						var missed_2_lt14_85=0;
						var missed_2_lt15_85=0;
						var missed_2_lt24_85=0;
						
						var missed_1_lt14_80=0;
						var missed_1_lt15_80=0;
						var missed_1_lt24_80=0;
						var missed_2_lt14_80=0;
						var missed_2_lt15_80=0;
						var missed_2_lt24_80=0;
						
						
						//Pill Count
						//Variables to hold total
						var pill_total_100=0;
						var pill_total_95=0;
						var pill_total_85=0;
						var pill_total_80=0;
						var pill_2_total_100=0;
						var pill_2_total_95=0;
						var pill_2_total_85=0;
						var pill_2_total_80=0;
						
						//Variables to hold gender
						var pill_1_male_100=0;
						var pill_1_female_100=0;
						var pill_1_male_95=0;
						var pill_1_female_95=0;
						var pill_1_male_85=0;
						var pill_1_female_85=0;
						var pill_1_male_80=0;
						var pill_1_female_80=0;
						var pill_2_male_100=0;
						var pill_2_female_100=0;
						var pill_2_male_95=0;
						var pill_2_female_95=0;
						var pill_2_male_85=0;
						var pill_2_female_85=0;
						var pill_2_male_80=0;
						var pill_2_female_80=0;
						
						//Variables for Age
						var pill_1_lt14_100=0;
						var pill_1_lt15_100=0;
						var pill_1_lt24_100=0;
						var pill_2_lt14_100=0;
						var pill_2_lt15_100=0;
						var pill_2_lt24_100=0;
						
						var pill_1_lt14_95=0;
						var pill_1_lt15_95=0;
						var pill_1_lt24_95=0;
						var pill_2_lt14_95=0;
						var pill_2_lt15_95=0;
						var pill_2_lt24_95=0;
						
						var pill_1_lt14_85=0;
						var pill_1_lt15_85=0;
						var pill_1_lt24_85=0;
						var pill_2_lt14_85=0;
						var pill_2_lt15_85=0;
						var pill_2_lt24_85=0;
						
						var pill_1_lt14_80=0;
						var pill_1_lt15_80=0;
						var pill_1_lt24_80=0;
						var pill_2_lt14_80=0;
						var pill_2_lt15_80=0;
						var pill_2_lt24_80=0;
						
						var no_adherence=0;
						var errors_count = 0;
						var count=0;

						for(var i = 0; i < results.rows.length; i++) {
							var parent_row = results.rows.item(i);

							var adherence_by_appointment = 0;
							var pill_count = 0;
							var missed_pills = 0;

							var adherence_by_appointment = parent_row['adherence'];
							var pill_count = parent_row['pill_count'];
							var missed_pills = parent_row['missed_pills'];
							var dose_frequency = parent_row['frequency'];
							var gender=parent_row['gender'];
							var age=parent_row['age'];
							var adherence_by_self = "Not Computed";
							var adherence_by_pill = "Not Computed";
							var adherence_by_appointment = "Not Computed";
							
							var hey=parent_row['adherence'];
							hey=$.trim(hey);
							if(hey.length>0) {
								//calculate adherence by missed pills
								if(dose_frequency == 1) {
									if(missed_pills <= 0) {
										missed_total_100++;
										if(gender==1){
											missed_1_male_100++;
										}
										else if(gender==2){
											missed_1_female_100++;
										}
										//Age
										if(age<14){
											missed_1_lt14_100++;
										}
										else if(age>24){
											missed_1_lt24_100++;
										}else{
											missed_1_lt15_100++;
										}
										
									} else if(missed_pills < 2 && missed_pills > 0) {
										missed_total_95++;
										if(gender==1){
											missed_1_male_95++;
										}
										else if(gender==2){
											missed_1_female_95++;
										}
										
										//Age
										if(age<14){
											missed_1_lt14_95++;
										}
										else if(age>24){
											missed_1_lt24_95++;
										}else{
											missed_1_lt15_95++;
										}
										
									} else if(missed_pills >= 2 && missed_pills <= 4) {
										missed_total_85++;
										if(gender==1){
											missed_1_male_85++;
										}
										else if(gender==2){
											missed_1_female_85++;
										}
										
										//Age
										if(age<14){
											missed_1_lt14_85++;
										}
										else if(age>24){
											missed_1_lt24_85++;
										}else{
											missed_1_lt15_85++;
										}
									} else if(missed_pills >= 5) {
										missed_total_80++;
										if(gender==1){
											missed_1_male_80++;
										}
										else if(gender==2){
											missed_1_female_80++;
										}
										
										//Age
										if(age<14){
											missed_1_lt14_80++;
										}
										else if(age>24){
											missed_1_lt24_80++;
										}else{
											missed_1_lt15_80++;
										}
									}
									
									
								}
								else if(dose_frequency == 2) {
									if(missed_pills <= 0) {
										missed_2_total_100++;
										if(gender==1){
											missed_2_male_100++;
										}
										else if(gender==2){
											missed_2_female_100++;
										}
										
										//Age
										if(age<14){
											missed_2_lt14_100++;
										}
										else if(age>24){
											missed_2_lt24_100++;
										}else{
											missed_2_lt15_100++;
										}
									} else if(missed_pills <= 3 && missed_pills > 0) {
										missed_2_total_95++;
										if(gender==1){
											missed_2_male_95++;
										}
										else if(gender==2){
											missed_2_female_95++;
										}
										
										//Age
										if(age<14){
											missed_2_lt14_95++;
										}
										else if(age>24){
											missed_2_lt24_95++;
										}else{
											missed_2_lt15_95++;
										}
									} else if(missed_pills >= 4 && missed_pills <= 8) {
										missed_2_total_85++;
										if(gender==1){
											missed_2_male_85++;
										}
										else if(gender==2){
											missed_2_female_85++;
										}
										
										//Age
										if(age<14){
											missed_2_lt14_85++;
										}
										else if(age>24){
											missed_2_lt24_85++;
										}else{
											missed_2_lt15_85++;
										}
									} else if(missed_pills >= 9) {
										missed_2_total_80++;
										if(gender==1){
											missed_2_male_80++;
										}
										else if(gender==2){
											missed_2_female_80++;
										}
										
										//Age
										if(age<14){
											missed_2_lt14_80++;
										}
										else if(age>24){
											missed_2_lt24_80++;
										}else{
											missed_2_lt15_80++;
										}
									}
								}
	
								//calculate adherence by pill count
								if(dose_frequency == 1) {
									
									if(pill_count <= 0) {
										pill_total_100++;
										if(gender==1){
											pill_1_male_100++;
										}
										else if(gender==2){
											pill_1_female_100++;
										}
										//Age
										if(age<14){
											pill_1_lt14_100++;
										}
										else if(age>24){
											pill_1_lt24_100++;
										}else{
											pill_1_lt15_100++;
										}
										
									} else if(pill_count < 2 && pill_count > 0) {
										pill_total_95++;
										if(gender==1){
											pill_1_male_95++;
										}
										else if(gender==2){
											pill_1_female_95++;
										}
										
										//Age
										if(age<14){
											pill_1_lt14_95++;
										}
										else if(age>24){
											pill_1_lt24_95++;
										}else{
											pill_1_lt15_95++;
										}
										
									} else if(pill_count >= 2 && pill_count <= 4) {
										pill_total_85++;
										if(gender==1){
											pill_1_male_85++;
										}
										else if(gender==2){
											pill_1_female_85++;
										}
										
										//Age
										if(age<14){
											pill_1_lt14_85++;
										}
										else if(age>24){
											pill_1_lt24_85++;
										}else{
											pill_1_lt15_85++;
										}
									} else if(pill_count >= 5) {
										pill_total_80++;
										if(gender==1){
											pill_1_male_80++;
										}
										else if(gender==2){
											pill_1_female_80++;
										}
										
										//Age
										if(age<14){
											pill_1_lt14_80++;
										}
										else if(age>24){
											pill_1_lt24_80++;
										}else{
											pill_1_lt15_80++;
										}
									}
									
								}
								
								else if(dose_frequency == 2) {
									if(pill_count <= 0) {
										pill_2_total_100++;
										if(gender==1){
											pill_2_male_100++;
										}
										else if(gender==2){
											pill_2_female_100++;
										}
										
										//Age
										if(age<14){
											pill_2_lt14_100++;
										}
										else if(age>24){
											pill_2_lt24_100++;
										}else{
											pill_2_lt15_100++;
										}
									} else if(pill_count <= 3 && pill_count > 0) {
										pill_2_total_95++;
										if(gender==1){
											pill_2_male_95++;
										}
										else if(gender==2){
											pill_2_female_95++;
										}
										
										//Age
										if(age<14){
											pill_2_lt14_95++;
										}
										else if(age>24){
											pill_2_lt24_95++;
										}else{
											pill_2_lt15_95++;
										}
									} else if(pill_count >= 4 && pill_count <= 8) {
										pill_2_total_85++;
										if(gender==1){
											pill_2_male_85++;
										}
										else if(gender==2){
											pill_2_female_85++;
										}
										
										//Age
										if(age<14){
											pill_2_lt14_85++;
										}
										else if(age>24){
											pill_2_lt24_85++;
										}else{
											pill_2_lt15_85++;
										}
									} else if(pill_count >= 9) {
										pill_2_total_80++;
										if(gender==1){
											pill_2_male_80++;
										}
										else if(gender==2){
											pill_2_female_80++;
										}
										
										//Age
										if(age<14){
											pill_2_lt14_80++;
										}
										else if(age>24){
											pill_2_lt24_80++;
										}else{
											pill_2_lt15_80++;
										}
									}
								}
							

							//calculate adherence by appointment
								count++;
								adherence_rate = parent_row['adherence'];
								if(adherence_rate == "100%") {
									appoint_pills_count_100++;
									
									if(parent_row['service']==5) {
										appointment_oi_100++;
									}else{
										appointment_arv_100++;
									}
									if(parent_row['gender']==1) {
										appointment_male_100++;
									}
									else if(parent_row['gender']==2) {
										appointment_female_100++;
									}
									if(parent_row['age']<14){
										appointment_lt14_100++;
									}
									else if(parent_row['age']>24){
										appointment_lt24_100++;
									}else{
										appointment_lt15_100++;
									}
									
									//Missed appointments
									
									
									
								} else if(adherence_rate == ">=95%") {
									appoint_pills_count_95++;
									if(parent_row['service']==5) {
										appointment_oi_95++;
									}else{
										appointment_arv_95++;
									}
									if(parent_row['gender']==1) {
										appointment_male_95++;
									}
									if(parent_row['gender']==2) {
										appointment_female_95++;
									}
									
									if(parent_row['age']<14){
										appointment_lt14_95++;
									}
									else if(parent_row['age']>24){
										appointment_lt24_95++;
									}else{
										appointment_lt15_95++;
									}
								} else if(adherence_rate == "85-94%" || adherence_rate == "84-94%") {
									appoint_pills_count_85++;
									if(parent_row['service']==5) {
										appointment_oi_85++;
									}else{
										appointment_arv_85++;
									}
									if(parent_row['gender']==1) {
										appointment_male_85++;
									}
									if(parent_row['gender']==2) {
										appointment_female_85++;
									}
									
									if(parent_row['age']<14){
										appointment_lt14_85++;
									}
									else if(parent_row['age']>24){
										appointment_lt24_85++;
									}else{
										appointment_lt15_85++;
									}
								} else if(adherence_rate == "<85%" || adherence_rate == "<84%") {
									appoint_pills_count_80++;
									if(parent_row['service']==5) {
										appointment_oi_80++;
									}else{
										appointment_arv_80++;
									}
									if(parent_row['gender']==1) {
										appointment_male_80++;
									}
									if(parent_row['gender']==2) {
										appointment_female_80++;
									}
									
									if(parent_row['age']<14){
										appointment_lt14_80++;
									}
									else if(parent_row['age']>24){
										appointment_lt24_80++;
									}else{
										appointment_lt15_80++;
									}
								}
								else{
									//alert(parent_row['adherence']);
								no_adherence++;
							    }

							}
							

							if(dose_frequency > 2) {
								errors_count++;
							}

						}
						$("#appointment_total_100").text(appoint_pills_count_100);
						$("#appointment_total_95").text(appoint_pills_count_95);
						$("#appointment_total_85").text(appoint_pills_count_85);
						$("#appointment_total_80").text(appoint_pills_count_80);
						
						
						//Appointments ARVs/OI
						$("#appointment_arv_100").text(appointment_arv_100);
						$("#appointment_arv_95").text(appointment_arv_95);
						$("#appointment_arv_85").text(appointment_arv_85);
						$("#appointment_arv_80").text(appointment_arv_80);
						
						//Appointments /OI
						$("#appointment_oi_100").text(appointment_oi_100);
						$("#appointment_oi_95").text(appointment_oi_95);
						$("#appointment_oi_85").text(appointment_oi_85);
						$("#appointment_oi_80").text(appointment_oi_80);
						
						
						
						//Appointments for Age
						$("#appointment_lt14_100").text(appointment_lt14_100);
						$("#appointment_15-24_100").text(appointment_lt15_100);
						$("#appointment_gt24_100").text(appointment_lt24_100);
						
						$("#appointment_lt14_95").text(appointment_lt14_95);
						$("#appointment_15-24_95").text(appointment_lt15_95);
						$("#appointment_gt24_95").text(appointment_lt24_95);

						$("#appointment_lt14_85").text(appointment_lt14_85);
						$("#appointment_15-24_85").text(appointment_lt15_85);
						$("#appointment_gt24_85").text(appointment_lt24_85);

						$("#appointment_lt14_80").text(appointment_lt14_80);
						$("#appointment_15-24_80").text(appointment_lt15_80);
						$("#appointment_gt24_80").text(appointment_lt24_80);

						
						//Apointment Gender
						$("#appointment_male_100").text(appointment_male_100);
						$("#appointment_female_100").text(appointment_female_100);
						$("#appointment_male_95").text(appointment_male_95);
						$("#appointment_female_95").text(appointment_female_95);
						$("#appointment_male_85").text(appointment_male_85);
						$("#appointment_female_85").text(appointment_female_85);
						$("#appointment_male_80").text(appointment_male_80);
						$("#appointment_female_80").text(appointment_female_80);

						//Missed dose total
						$("#missed_total_100").text(missed_total_100);
						$("#missed_2_total_100").text(missed_2_total_100);
						$("#missed_total_95").text(missed_total_95);
						$("#missed_2_total_95").text(missed_2_total_95);
						$("#missed_total_85").text(missed_total_85);
						$("#missed_2_total_85").text(missed_2_total_85);
						$("#missed_total_80").text(missed_total_80);
						$("#missed_2_total_80").text(missed_2_total_80);
						
						
						//Pill Count total
						$("#pill_total_100").text(pill_total_100);
						$("#pill_2_total_100").text(pill_2_total_100);
						$("#pill_total_95").text(pill_total_95);
						$("#pill_2_total_95").text(pill_2_total_95);
						$("#pill_total_85").text(pill_total_85);
						$("#pill_2_total_85").text(pill_2_total_85);
						$("#pill_total_80").text(pill_total_80);
						$("#pill_2_total_80").text(pill_2_total_80);

						//Missed dose gender
						$("#missed_1_male_100").text(missed_1_male_100);
						$("#missed_1_male_95").text(missed_1_male_95);
						$("#missed_1_male_85").text(missed_1_male_85);
						$("#missed_1_male_80").text(missed_1_male_80);
						$("#missed_1_female_100").text(missed_1_female_100);
						$("#missed_1_female_95").text(missed_1_female_95);
						$("#missed_1_female_85").text(missed_1_female_85);
						$("#missed_1_female_80").text(missed_1_female_80);
						
						$("#missed_2_male_100").text(missed_2_male_100);
						$("#missed_2_male_95").text(missed_2_male_95);
						$("#missed_2_male_85").text(missed_2_male_85);
						$("#missed_2_male_80").text(missed_2_male_80);
						$("#missed_2_female_100").text(missed_2_female_100);
						$("#missed_2_female_95").text(missed_2_female_95);
						$("#missed_2_female_85").text(missed_2_female_85);
						$("#missed_2_female_80").text(missed_2_female_80);
						
						
						//Pill Count gender
						$("#pill_1_male_100").text(pill_1_male_100);
						$("#pill_1_male_95").text(pill_1_male_95);
						$("#pill_1_male_85").text(pill_1_male_85);
						$("#pill_1_male_80").text(pill_1_male_80);
						$("#pill_1_female_100").text(pill_1_female_100);
						$("#pill_1_female_95").text(pill_1_female_95);
						$("#pill_1_female_85").text(pill_1_female_85);
						$("#pill_1_female_80").text(pill_1_female_80);
						
						$("#pill_2_male_100").text(pill_2_male_100);
						$("#pill_2_male_95").text(pill_2_male_95);
						$("#pill_2_male_85").text(pill_2_male_85);
						$("#pill_2_male_80").text(pill_2_male_80);
						$("#pill_2_female_100").text(pill_2_female_100);
						$("#pill_2_female_95").text(pill_2_female_95);
						$("#pill_2_female_85").text(pill_2_female_85);
						$("#pill_2_female_80").text(pill_2_female_80);
						
						//Missed dose age
						$("#missed_1_lt14_100").text(missed_1_lt14_100);
						$("#missed_1_lt14_95").text(missed_1_lt14_95);
						$("#missed_1_lt14_85").text(missed_1_lt14_85);
						$("#missed_1_lt14_80").text(missed_1_lt14_80);
						
						$("#missed_1_15-24_100").text(missed_1_lt15_100);
						$("#missed_1_15-24_95").text(missed_1_lt15_95);
						$("#missed_1_15-24_85").text(missed_1_lt15_85);
						$("#missed_1_15-24_80").text(missed_1_lt15_80);
						
						$("#missed_1_gt25_100").text(missed_1_lt24_100);
						$("#missed_1_gt25_95").text(missed_1_lt24_95);
						$("#missed_1_gt25_85").text(missed_1_lt24_85);
						$("#missed_1_gt25_80").text(missed_1_lt24_80);
						
						$("#missed_2_lt14_100").text(missed_2_lt14_100);
						$("#missed_2_lt14_95").text(missed_2_lt14_95);
						$("#missed_2_lt14_85").text(missed_2_lt14_85);
						$("#missed_2_lt14_80").text(missed_2_lt14_80);
						
						$("#missed_2_15-24_100").text(missed_2_lt15_100);
						$("#missed_2_15-24_95").text(missed_2_lt15_95);
						$("#missed_2_15-24_85").text(missed_2_lt15_85);
						$("#missed_2_15-24_80").text(missed_2_lt15_80);
						
						$("#missed_2_gt25_100").text(missed_2_lt24_100);
						$("#missed_2_gt25_95").text(missed_2_lt24_95);
						$("#missed_2_gt25_85").text(missed_2_lt24_85);
						$("#missed_2_gt25_80").text(missed_2_lt24_80);
						
						
						//Pill count age
						$("#pill_1_lt14_100").text(pill_1_lt14_100);
						$("#pill_1_lt14_95").text(pill_1_lt14_95);
						$("#pill_1_lt14_85").text(pill_1_lt14_85);
						$("#pill_1_lt14_80").text(pill_1_lt14_80);
						
						$("#pill_1_15-24_100").text(pill_1_lt15_100);
						$("#pill_1_15-24_95").text(pill_1_lt15_95);
						$("#pill_1_15-24_85").text(pill_1_lt15_85);
						$("#pill_1_15-24_80").text(pill_1_lt15_80);
						
						$("#pill_1_gt25_100").text(pill_1_lt24_100);
						$("#pill_1_gt25_95").text(pill_1_lt24_95);
						$("#pill_1_gt25_85").text(pill_1_lt24_85);
						$("#pill_1_gt25_80").text(pill_1_lt24_80);
						
						$("#pill_2_lt14_100").text(pill_2_lt14_100);
						$("#pill_2_lt14_95").text(pill_2_lt14_95);
						$("#pill_2_lt14_85").text(pill_2_lt14_85);
						$("#pill_2_lt14_80").text(pill_2_lt14_80);
						
						$("#pill_2_15-24_100").text(pill_2_lt15_100);
						$("#pill_2_15-24_95").text(pill_2_lt15_95);
						$("#pill_2_15-24_85").text(pill_2_lt15_85);
						$("#pill_2_15-24_80").text(pill_2_lt15_80);
						
						$("#pill_2_gt25_100").text(pill_2_lt24_100);
						$("#pill_2_gt25_95").text(pill_2_lt24_95);
						$("#pill_2_gt25_85").text(pill_2_lt24_85);
						$("#pill_2_gt25_80").text(pill_2_lt24_80);
						
                         /*
						$("#pills_100_1").text(pills_count_100);
						$("#pills_100_2").text(pills_count_95);
						$("#pills_100_3").text(pills_count_85);
						$("#pills_100_4").text(pills_count_80);

						$("#pills_200_1").text(two_pills_count_100);
						$("#pills_200_2").text(two_pills_count_95);
						$("#pills_200_3").text(two_pills_count_85);
						$("#pills_200_4").text(two_pills_count_80);

						$("#no_adherence").text(no_adherence);
						$("#error_count").text(errors_count);
						*/
						$("#total_count").text(count);
					});
				});
				var x = 0;
				var y = 0;

				$("#start_date").datepicker({
					changeMonth : true,
					changeYear : true,
					dateFormat : 'yy-mm-dd'
				});
				$("#start_date").change(function() {
					if(x == 0) {
						x = 1;
					}
					var _start_date = $("#start_date").attr("value");
					var _end_date = $("#end_date").attr("value");
					var report_url = "patients_adherence.html#?start_date=" + _start_date + "&end_date=" + _end_date;
					if(y == 1) {
						window.location = report_url;
						location.reload();
					}

				});
				$("#end_date").datepicker({
					changeMonth : true,
					changeYear : true,
					dateFormat : 'yy-mm-dd'
				});
				$("#end_date").change(function() {
					if(y == 0) {
						y = 1;
					}
					var _start_date = $("#start_date").attr("value");
					var _end_date = $("#end_date").attr("value");
					var report_url = "patients_adherence.html#?start_date=" + _start_date + "&end_date=" + _end_date;
					if(x == 1) {
						window.location = report_url;
						location.reload();
					}

				});
			});
			function numberWithCommas(x) {
				return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			}
		</script>
	</head>
	<body>
		<style>
			#patient_listing {
				margin: 0 auto;
				border-top: 1px solid #B9B9B9;
				font-size: 14px;
				letter-spacing: 1px;
				border: 1px solid #000;
			}
			#appointment_listing, #missed_doses, #pill_count {
				margin: 0 auto;
				border-top: 1px solid #B9B9B9;
				font-size: 14px;
				letter-spacing: 1px;
				border: 1px solid #000;
				width: 1100px;
			}
			#patient_listing td, th {
				letter-spacing: 1px;
				padding: 5px;
				font-family: Times;
			}
			.report_title {
				color: rgb(34, 86, 253);
				letter-spacing: 1px;
				padding: 5px;
				font-size: 14px;
				font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
			}
			#adherence_form {
				margin: 0 auto;
				display: block;
			}
			table {
				border-collapse: collapse;
			}
			td {
				padding: 7px;
			}
			tr th {
				font-size: 16px;
			}
			thead th {
				background-color: rgb(214, 238, 238);
			}
			._status {
				color: rgb(6, 133, 233);
			}
			._age {
				color: rgb(0, 190, 46);
			}
			._sex {
				color: rgb(169, 0, 248);
			}
			._total {
				font-weight: bold;
			}
		</style>
		<!-- Menus -->
		<div class="navbar ">
			<div class="navbar-inner">
				<div class="container">
					<!-- Everything you want hidden at 940px or less, place within here -->
					<div class="nav-collapse collapse" id="acdmenu">
						<a class="brand" href="../reports.html"/><img src="../Images/home-icon.png"> | </a>
						<ul class="nav">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown" id="standard_report"> Standard Reports <b class="caret"></b> </a>
								<ul class="dropdown-menu" id="standard_report_sub">
									<li>
										<a href="#" id="patients_enrolled_in_period" class="report donor_date_range_report active_report">Number of Patients Enrolled in Period</a>
									</li>
									<li>
										<a href="#" id="patients_enrolled_in_art" class="report donor_date_range_report active_report">Number of Patients Started on ART in the Period</a>
									</li>
									<li>
										<a href="#" id="graph_patients_enrolled_in_year" class="report active_report annual_report">Graph of Number of Patients Enrolled Per Month in a Given Year</a>
									</li>
									<li>
										<a href="#" id="cumulative_patients" class="report active_report single_date_report">Cumulative Number of Patients to Date</a>
									</li>
									<li>
										<a href="#" id="patients_on_ART_active" class="report active_report no_filter">Number of Active Patients Receiving ART (by Regimen)</a>
									</li>
								</ul>
							</li>
							<li class="dropdown divider-vertical" id="visiting_patient">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown"> Visiting Patients <b class="caret"></b> </a>
								<ul class="dropdown-menu" id="visiting_patient_sub">
									<li>
										<a href="#" id="patients_scheduled_to_visit" class="report active_report date_range_report">List of Patients Scheduled to Visit</a>
									</li>
									<li>
										<a href="#" id="patients_started_on_date" class="report active_report date_range_report">List of Patients Started (on a Particular Date)</a>
									</li>
									<li>
										<a href="#" id="patients_visitied_for_refill" class="report active_report date_range_report">List of Patients Visited for Refill</a>
									</li>
									<li>
										<a href="#" id="patients_missing_appointments" class="report active_report date_range_report">Patients Missing Appointments</a>
									</li>
									<li>
										<a href="#" id="patients_adherence" class="report active_report date_range_report">Patients Adherence Report</a>
									</li>
								</ul>
							</li>
							<li class="dropdown divider-vertical">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown" id="early_warning"> Early Warning Indicators <b class="caret"></b> </a>
								<ul class="dropdown-menu " id="early_warning_sub">
									<li>
										<a href="#" id="patients_who_changed_regimen" class="report active_report date_range_report">Active Patients who Have Changed Regimens</a>
									</li>
									<li>
										<a href="#" id="patients_starting" class="report active_report date_range_report">List of Patients Starting (By Regimen)</a>
									</li>
									<li>
										<a href="#" id="early_warning_indicators" class="report active_report date_range_report">HIV Early Warning Indicators</a>
									</li>
									<li>
										<a href="#" id="service_statistics" class="report active_report single_date_report">Service Statistics (By Regimen)</a>
									</li>
								</ul>
							</li>
							<li class="dropdown divider-vertical">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown" id="drug_inventory"> Drug Inventory <b class="caret"></b> </a>
								<ul class="dropdown-menu" id="drug_inventory_sub">
									<li>
										<a href="#" id="drug_consumption" class="report active_report annual_report">Drug Consumption Report</a>
									</li>
									<li>
										<a href="#" id="drug_stock_on_hand" class="report active_report no_filter">Drug Stock on Hand Report</a>
									</li>
									<li>
										<a href="#" id="commodity_summary" class="report active_report date_range_report">Facility Summary Commodity Report</a>
									</li>
									<li>
										<a href="#" id="expiring_drugs" class="report active_report no_filter">Short Dated Stocks &lt;6 Months to Expiry</a>
									</li>
									<li>
										<a href="#" id="expired_drugs" class="report active_report no_filter">List of Expired Drugs</a>
									</li>
								</ul>
							</li>
						</ul>
						<a onClick="window.print()" class="brand" title="Print this page"/> | <img src="../Images/printing_icon.png"> </a>
					</div>
				</div>
			</div>
		</div>
		<!-- Menus end -->
		<h2 id="facility_name" style="text-align: center"></h2>
		<h4 style="text-align: center">Patients Adherence Summary
		<br>
		<br>
		Between
		<input type="text" id="start_date">
		and
		<input type="text" id="end_date">
		</h4>
		<hr size="1" style="width:80%">
		<h5 class="report_title" style="text-align: center">Number Of Patients: <span id="total_count"></span></h5>
		<div id="adherence_form">
			<div style="text-align: center">
				<h3>Adherence By Appointment</h3>
			</div>
			<table id="appointment_listing" border="1" cellpadding="3" cellspacing="5">
				<thead>
					<tr>
						<th class="h1" rowspan="2">No of Days Missed</th>
						<th class="h1" rowspan="2">Adherence %</th>
						<th class="h1" rowspan="2">Total</th>
						<th class="h1 _status" colspan="2">Status</th>
						<th class="h1 _sex" colspan="2" >Sex</th>
						<th class="h1 _age" colspan="3" >Age(years)</th>
					</tr>
					<tr>
						<th class="_status">ARVs</th>
						<th class="_status">OIs</th>
						<th class="_sex">Male</th>
						<th class="_sex">Female</th>
						<th class="_age" width="45">&lt;14</th>
						<th class="_age" width="45">15-24</th>
						<th class="_age">&gt;24</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>0</td><td>100%</td><td id="appointment_total_100" class="_total"></td><td id="appointment_arv_100" class="_status"></td><td id="appointment_oi_100" class="_status"></td><td id="appointment_male_100" class="_sex"></td><td id="appointment_female_100" class="_sex"></td><td id="appointment_lt14_100" class="_age"></td><td id="appointment_15-24_100" class="_age"><td id="appointment_gt24_100" class="_age"></td>
					</tr>
					<tr>
						<td>Within 2 days</td><td>&gt;=95 %</td><td id="appointment_total_95" class="_total"></td><td id="appointment_arv_95" class="_status"></td><td id="appointment_oi_95" class="_status"></td><td id="appointment_male_95" class="_sex"></td><td id="appointment_female_95" class="_sex"></td><td id="appointment_lt14_95" class="_age"></td><td id="appointment_15-24_95" class="_age"><td id="appointment_gt24_95" class="_age"></td>
					</tr>
					<tr>
						<td>3 - 14 days</td><td>85 - 94 %</td><td id="appointment_total_85" class="_total"></td><td id="appointment_arv_85" class="_status"></td><td id="appointment_oi_85" class="_status"></td><td id="appointment_male_85" class="_sex"></td><td id="appointment_female_85" class="_sex"></td><td id="appointment_lt14_85" class="_age"></td><td id="appointment_15-24_85" class="_age"><td id="appointment_gt24_85" class="_age"></td>
					</tr>
					<tr>
						<td>14 and above</td><td>&lt; 85 %</td><td id="appointment_total_80" class="_total"></td><td id="appointment_arv_80" class="_status"></td><td id="appointment_oi_80" class="_status"></td><td id="appointment_male_80" class="_sex"></td><td id="appointment_female_80" class="_sex"></td><td id="appointment_lt14_80" class="_age"></td><td id="appointment_15-24_80" class="_age"><td id="appointment_gt24_80" class="_age"></td>
					</tr>
				</tbody>
			</table>
			<div style="text-align: center">
				<h3>Adherence By Missed Doses</h3>
			</div>
			<table id="missed_doses" border="1" cellpadding="3" cellspacing="5">
				<thead>
					<tr>
						<th class="h1" rowspan="2">Percentage (%)</th>
						<th class="h1" rowspan="2">No .of Doses Missed(1x)</th>
						<th class="h1" rowspan="2">Total(1x) Dosing</th>
						<th class="h1 _sex" colspan="2" >Sex</th>
						<th class="h1 _age" colspan="3" >Age(years)</th>
						<th class="h1" rowspan="2">No .of Doses Missed(2x)</th>
						<th class="h1" rowspan="2">Total(2x) Dosing</th>
						<th class="h1 _sex" colspan="2" >Sex</th>
						<th class="h1 _age" colspan="3" >Age(years)</th>
					</tr>
					<tr>
						<th class="_sex">Male</th>
						<th class="_sex">Female</th>
						<th class="_age">&lt;14</th>
						<th class="_age" width="45">15-24</th>
						<th class="_age">&gt;24</th>
						<th class="_sex">Male</th>
						<th class="_sex">Female</th>
						<th class="_age">&lt;14</th>
						<th class="_age" width="45">15-24</th>
						<th class="_age">&gt;24</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>100%</td><td>0 Doses</td><td class="_total" id="missed_total_100"></td><td id="missed_1_male_100"></td><td id="missed_1_female_100"></td><td id="missed_1_lt14_100"></td><td id="missed_1_15-24_100"></td><td id="missed_1_gt25_100"></td><td>0 Doses</td><td id="missed_2_total_100"></td><td id="missed_2_male_100"></td><td id="missed_2_female_100"></td><td id="missed_2_lt14_100"></td><td id="missed_2_15-24_100"></td><td id="missed_2_gt25_100"></td>
					</tr>
					<tr>
						<td>&gt;=95%</td><td>&lt; 2 Doses</td><td class="_total" id="missed_total_95"></td><td id="missed_1_male_95"></td><td id="missed_1_female_95"></td><td id="missed_1_lt14_95"></td><td id="missed_1_15-24_95"></td><td id="missed_1_gt25_95"></td><td>&lt;=3 Doses</td><td id="missed_2_total_95"></td><td id="missed_2_male_95"></td><td id="missed_2_female_95"></td><td id="missed_2_lt14_95"></td><td id="missed_2_15-24_95"></td><td id="missed_2_gt25_95"></td>
					</tr>
					<tr>
						<td>85 - 94%</td><td>2 -4 Doses</td><td class="_total" id="missed_total_85"></td><td id="missed_1_male_85"></td><td id="missed_1_female_85"></td><td id="missed_1_lt14_85"></td><td id="missed_1_15-24_85"></td><td id="missed_1_gt25_85"></td><td>4 - 8 Doses</td><td id="missed_2_total_85"></td><td id="missed_2_male_85"></td><td id="missed_2_female_85"></td><td id="missed_2_lt14_85"></td><td id="missed_2_15-24_85"></td><td id="missed_2_gt25_85"></td>
					</tr>
					<tr>
						<td>&lt; 85%</td><td>&gt;= 5 Doses</td><td class="_total" id="missed_total_80"></td><td id="missed_1_male_80"></td><td id="missed_1_female_80"></td><td id="missed_1_lt14_80"></td><td id="missed_1_15-24_80"></td><td id="missed_1_gt25_80"></td><td>&gt; =9 Doses</td><td id="missed_2_total_80"></td><td id="missed_2_male_80"></td><td id="missed_2_female_80"></td><td id="missed_2_lt14_80"></td><td id="missed_2_15-24_80"></td><td id="missed_2_gt25_80"></td>
					</tr>
				</tbody>
			</table>
			<div style="text-align: center">
				<h3>Adherence By Pill Count</h3>
			</div>
			<table id="pill_count" border="1" cellpadding="3" cellspacing="5">
				<thead>
					<tr>
						<th class="h1" rowspan="2">Percentage (%)</th>
						<th class="h1" rowspan="2">No .of Doses Missed(1x)</th>
						<th class="h1" rowspan="2">Total(1x) Dosing</th>
						<th class="h1 _sex" colspan="2" >Sex</th>
						<th class="h1 _age" colspan="3" >Age(years)</th>
						<th class="h1" rowspan="2">No .of Doses Missed(2x)</th>
						<th class="h1" rowspan="2">Total(2x) Dosing</th>
						<th class="h1 _sex" colspan="2" >Sex</th>
						<th class="h1 _age" colspan="3" >Age(years)</th>
					</tr>
					<tr>
						<th class="_sex">Male</th>
						<th class="_sex">Female</th>
						<th class="_age">&lt;14</th>
						<th class="_age" width="45">15-24</th>
						<th class="_age">&gt;24</th>
						<th class="_sex">Male</th>
						<th class="_sex">Female</th>
						<th class="_age">&lt;14</th>
						<th class="_age" width="45">15-24</th>
						<th class="_age">&gt;24</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>100%</td><td>0 Doses</td><td class="_total" id="pill_total_100"></td><td id="pill_1_male_100"></td><td id="pill_1_female_100"></td><td id="pill_1_lt14_100"></td><td id="pill_1_15-24_100"></td><td id="pill_1_gt25_100"></td><td>0 Doses</td><td id="pill_2_total_100"></td><td id="pill_2_male_100"></td><td id="pill_2_female_100"></td><td id="pill_2_lt14_100"></td><td id="pill_2_15-24_100"></td><td id="pill_2_gt25_100"></td>
					</tr>
					<tr>
						<td>&gt;=95%</td><td>&lt; 2 Doses</td><td class="_total" id="pill_total_95"></td><td id="pill_1_male_95"></td><td id="pill_1_female_95"></td><td id="pill_1_lt14_95"></td><td id="pill_1_15-24_95"></td><td id="pill_1_gt25_95"></td><td>&lt;=3 Doses</td><td id="pill_2_total_95"></td><td id="pill_2_male_95"></td><td id="pill_2_female_95"></td><td id="pill_2_lt14_95"></td><td id="pill_2_15-24_95"></td><td id="pill_2_gt25_95"></td>
					</tr>
					<tr>
						<td>85 - 94%</td><td>2 -4 Doses</td><td class="_total" id="pill_total_85"></td><td id="pill_1_male_85"></td><td id="pill_1_female_85"></td><td id="pill_1_lt14_85"></td><td id="pill_1_15-24_85"></td><td id="pill_1_gt25_85"></td><td>4 - 8 Doses</td><td id="pill_2_total_85"></td><td id="pill_2_male_85"></td><td id="pill_2_female_85"></td><td id="pill_2_lt14_85"></td><td id="pill_2_15-24_85"></td><td id="pill_2_gt25_85"></td>
					</tr>
					<tr>
						<td>&lt; 85%</td><td>&gt;= 5 Doses</td><td class="_total" id="pill_total_80"></td><td id="pill_1_male_80"></td><td id="pill_1_female_80"></td><td id="pill_1_lt14_80"></td><td id="pill_1_15-24_80"></td><td id="pill_1_gt25_80"></td><td>&gt; =9 Doses</td><td id="pill_2_total_80"></td><td id="pill_2_male_80"></td><td id="pill_2_female_80"></td><td id="pill_2_lt14_80"></td><td id="pill_2_15-24_80"></td><td id="pill_2_gt25_80"></td>
					</tr>
				</tbody>
			</table>
			<p>&nbsp;</p>
			<!--
			<p>
				<h5 class="report_title" style="text-align: center">(Dosing Greater Than 2x) Count: <span id="error_count"></span></h5>
				<h5 class="report_title" style="text-align: center">(No adherence) Count: <span id="no_adherence"></span></h5>
				
			-->
		</div>
		<!-- Pop up Window -->
		<div class="result"></div>
		<!-- Pop up Window end-->
	</body>
</html>